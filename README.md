# Coding Challenge 3

## Setup Instructions

Requirements

- .NET 7

To run the program, first install dependencies then run normally:

> dotnet restore

> dotnet run

## Sample Requests or Postman Collection

### View events

> curl localhost:5000/events

### POST events

```
curl --location --request POST 'localhost:5000/events' \
--header 'Content-Type: application/json' \
--data-raw '{

    "timestampInISO8601": "2025-2-18T12:53:18Z",
    "serviceName": "hello",
    "eventType": "ACTION",
    "payload": "base64"

}'
```

### POST replay events

```
curl --location --request POST 'localhost:5000/events/replay' \
--header 'Content-Type: application/json' \
--data-raw '{
    "ids": [
        "60255e26-ad6d-42fb-bb8a-c2f73f200a10",
        "b7c2ab2e-9fc0-4299-981d-d79ba3ffcaed"
    ]
}   '
```

## Assumptions and Areas for improvement

- Assumptions
  1. Data
     1. GUID is generated by this service and not by passing eventId in (as it may be possible to pass some id to relate to some entity)
     1. Persistence data should be immutable once written
     1. Data returned by API is sorted by time to better replay events
     1. Current state of system not required
  1. API calls
     1. Having greater Writes > Reads to capture event logs with low latency
  1. Future
     1. Eventual move to RabbitMQ/Kafka can involve a push to the API to leverage off current architecture
- Areas for improvement
  1. Add scoped logging to log through entire request
  1. Split parsing time range query parameter into a helper file
  1. Speed of retrieval (Related to Assumptions.2)
     1. Insertion of data is fast but retrieving data now takes time as the data structure used for persistence is unordered. When the amount of data increases, the retrieval will be a lot slower.
        1. Might need other/multiple data structures to better increase retrieval times. Better partition/store/aggregate data?
     1. Modify `ConcurrentBag<Audit>` to `ConcurrentDictionary<ID, Audit>` for faster retrieval for replay API
  1. Add interfaces for services to decouple layers
  1. Add middleware for exception handling/logging
  1. Add some comments for examples of models
  1. To not commit to main
